{
  "grokparsefailure": {
    "query": "tags:_grokparsefailure",
    "index_pattern": "logstash-*",
    "time_range": 360,
    "field_name": "type",
    "convert_timestamp_to_epoch": false,
    "type": "FIELD_QUERY",
    "base_64_used": false
  },
  "grokparsefailure_count": {
    "query": "tags:_grokparsefailure",
    "index_pattern": "logstash-*",
    "time_range": 360,
    "metric_name": "health._global.grokparsefailure_count",
    "type": "QUERY_COUNT",
    "base_64_used": false
  },
  "count_events_on_host": {
    "query": "type:syslog_nxlog AND LogType:WindowsEventLog AND EventID:{{#arg2}} AND host:{{#arg1}}",
    "index_pattern": "logstash-syslog_nxlog-*",
    "time_range": 3600,
    "metric_name": "host_behaviour.events_count_on_host.{{#arg1}}.{{#arg2}}",
    "type": "QUERY_COUNT",
    "base_64_used": false
  },
  "ids_alerts_for_host": {
    "query": "sotool:snort AND (dstip:{{#arg1}} OR srcip:{{#arg1}}) AND _exists_:priority AND priority:1) OR (sotool:bro_notice AND (dstip:{{#arg1}} OR srcip:{{#arg1}}))",
    "index_pattern": "logstash-*",
    "time_range": 300,
    "metric_name": "host_behaviour.ids_alerts_for_host.{{#arg1}}",
    "type": "QUERY_COUNT",
    "base_64_used": false
  },
  "ids_attacks_for_host": {
    "query": "sotool:snort AND (dstip:{{#arg1}} OR srcip:{{#arg1}}) AND _exists_:priority AND priority:2) OR (sotool:bro_notice AND (dstip:{{#arg1}} OR srcip:{{#arg1}}))",
    "index_pattern": "logstash-*",
    "time_range": 300,
    "metric_name": "host_behaviour.ids_attacks_for_host.{{#arg1}}",
    "type": "QUERY_COUNT",
    "base_64_used": false
  },
  "drops_per_internal_dstip": {
    "query": "type.raw:syslog_checkpoint AND status:drop AND dstip:{{#arg1}}))",
    "index_pattern": "logstash-*",
    "time_range": 300,
    "metric_name": "host_behaviour.drops_per_internal_dstip.{{#arg1}}",
    "type": "QUERY_COUNT",
    "base_64_used": false
  },
  "drops_per_internal_srcip": {
    "query": "type.raw:syslog_checkpoint AND status:drop AND srcip:{{#arg1}}))",
    "index_pattern": "logstash-*",
    "time_range": 300,
    "metric_name": "host_behaviour.drops_per_internal_srcip.{{#arg1}}",
    "type": "QUERY_COUNT",
    "base_64_used": false
  },
  "number_of_drops_per_policy": {
    "query": "sotool:snmptrapd_fortigate OR sotool:fortigate OR type:syslog_checkpoint) AND host:\"{{#arg1}}\" AND policyid:{{#arg2}} AND status:(\"blocked\" \"drop\" \"deny\")",
    "index_pattern": "logstash-*",
    "time_range": 300,
    "metric_name": "network_behaviour.drops_per_fw_policy.{{#arg1}}",
    "type": "QUERY_COUNT",
    "base_64_used": false
  },
  "events_per_type": {
    "query": "event_type:\"{{#arg1}}\"",
    "index_pattern": "logstash-*",
    "time_range": 300,
    "metric_name": "health._global.number_of_events_per_type.{{#arg1}}",
    "type": "QUERY_COUNT",
    "base_64_used": false
  },
  "events_per_source_ip": {
    "query": "source_ip:\"{{#arg1}}\"",
    "index_pattern": "logstash-*",
    "time_range": 300,
    "metric_name": "health._global.number_of_events_per_source_ip.{{#arg1}}",
    "type": "QUERY_COUNT",
    "base_64_used": false
  },
  "events_per_destination_ip": {
    "query": "destination_ip:\"{{#arg1}}\"",
    "index_pattern": "logstash-*",
    "time_range": 300,
    "metric_name": "health._global.number_of_events_per_destination_ip.{{#arg1}}",
    "type": "QUERY_COUNT",
    "base_64_used": false
  },
  "events_per_useragent": {
    "query": "useragent:\"{{#arg1}}\"",
    "index_pattern": "logstash-*",
    "time_range": 3600,
    "metric_name": "health._global.number_of_events_per_useragent.{{#arg1}}",
    "type": "QUERY_COUNT",
    "base_64_used": true
  },
  "number_of_handle_manipulation_and_audit_events_per_host": {
    "query": "_type:syslog_nxlog AND (EventID:4656 OR EventID:4658) AND host:\"{{#arg1}}\"",
    "index_pattern": "logstash-*",
    "time_range": 300,
    "metric_name": "host_behaviour.number_of_handle_manipulation_and_audit_events_per_host.{{#arg1}}",
    "type": "QUERY_COUNT",
    "base_64_used": false
  },
  "number_of_iis_log_reports_for_host_on_port": {
    "query": "(dstip:{{#arg1}} OR ((dstip:\\:\\:1 OR dstip:fe80\\:\\:\\:\\:) AND (s_computername:\"{{#arg2}}\" OR path:\"{{#arg2}}\"))) AND NOT dstip:10.253.0.170 AND sotool:iis AND dstport:{{#arg3}}",
    "index_pattern": "logstash-*",
    "time_range": 300,
    "metric_name": "host_behaviour.number_of_iis_log_reports_for_host_on_port.{{#arg1}}.{{#arg3}}",
    "type": "QUERY_COUNT",
    "base_64_used": false
  },
  "number_of_eicar_test_file": {
    "query": "type:syslog_mailalerts AND message:Eicar_test_file",
    "index_pattern": "logstash-*",
    "time_range": 300,
    "metric_name": "network_behaviour.number_of_eicar_test_file_alerts",
    "type": "QUERY_COUNT",
    "base_64_used": false
  },
  "number_of_iis_log_reports": {
    "query": "(dstip:{{#arg1}} OR ((dstip:\\:\\:1 OR dstip:fe80\\:\\:\\:\\:) AND (s_computername:\"{{#arg2}}\" OR path:\"{{#arg2}}\"))) AND sotool:iis AND dstport:{{#arg3}}",
    "index_pattern": "logstash-*",
    "time_range": 300,
    "metric_name": "host_behaviour.number_of_iis_log_reports.{{#arg1}}.{{#arg3}}",
    "type": "QUERY_COUNT",
    "base_64_used": false
  },
  "events_per_day": {
    "query": "*",
    "index_pattern": "logstash-*",
    "time_range": 86400,
    "metric_name": "health._global.number_of_events_per_day",
    "type": "QUERY_COUNT",
    "base_64_used": false
  },
  "discover_types": {
    "query": "*",
    "index_pattern": "logstash-*",
    "agg_on_field": "event_type.keyword",
    "zabbix_macro": "TYPE",
    "time_range": 86400,
    "type": "LLD"
  },
  "discover_sources": {
    "query": "*",
    "index_pattern": "logstash-bro-*",
    "agg_on_field": "source_ip",
    "zabbix_macro": "SRC_IP",
    "time_range": 86400,
    "type": "LLD"
  },
  "discover_destinations": {
    "query": "*",
    "index_pattern": "logstash-bro-*",
    "agg_on_field": "destination_ip",
    "zabbix_macro": "DST_IP",
    "time_range": 86400,
    "type": "LLD"
  },
  "discover_useragents": {
    "query": "*",
    "index_pattern": "logstash-bro-*",
    "agg_on_field": "useragent.keyword",
    "zabbix_macro": "USERAGENT",
    "time_range": 86400,
    "type": "LLD",
    "use_base64": true
  }
}
